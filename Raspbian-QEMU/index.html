<!DOCTYPE html><html domain=".io" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="default-src 'self';object-src 'none';script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com/ https://gist.github.com/ https://www.googletagmanager.com/ https://www.google-analytics.com https://raw.githubusercontent.com/choonkiatlee/jpake-js/;connect-src 'self' https://www.google-analytics.com;style-src 'self' https://fonts.googleapis.com/ https://use.fontawesome.com/ 'unsafe-inline' https://github.githubassets.com/ https://cdn.jsdelivr.net;img-src 'self' data:;font-src 'self' https://fonts.gstatic.com/ https://use.fontawesome.com/ https://cdn.jsdelivr.net" http-equiv="Content-Security-Policy"><link href="/img/curious-koala.svg" rel="icon"><meta content="#f9c412" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>Raspbian on your laptop: QEMU</title><meta content="Raspbian on your laptop: QEMU" property="og:title"><meta content="TLDR ðŸ”— raspbian is a docker image that allows you to run a fast raspbian image built for ARM directly on your x86 desktop. Test it out..." name="description"><meta content="TLDR ðŸ”— raspbian is a docker image that allows you to run a fast raspbian image built for ARM directly on your x86 desktop. Test it out..." property="og:description"><meta content="summary_large_image" name="twitter:card"><meta content="@" name="twitter:site"><meta content="@" name="twitter:creator"><meta content="https://choonkiatlee.github.io/img/remote/2tQwWm.svg" property="og:image"><meta content="article" property="og:type"><link href="https://choonkiatlee.github.io/Raspbian-QEMU/" rel="canonical"><meta content="https://choonkiatlee.github.io/Raspbian-QEMU/" property="og:url"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/" rel="preconnect" crossorigin=""><script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script><script src="/js/min.js?hash=4b0c17b752" async="" defer=""></script><script src="https://www.googletagmanager.com/gtag/js?id=G-K3YRSB918B" async=""></script><script>window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());
			gtag('config', 'G-K3YRSB918B');</script><link href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css" rel="stylesheet"><script csp-hash="sha256-bmszMnxMgg1Hk+0nIGQ/g6+qv68Oyq3nSRp+I2DBxrI=">if (/Mac OS X/.test(navigator.userAgent))
			document
				.documentElement
				.classList
				.add('apple')</script><style>@charset "UTF-8";@font-face{font-display:swap;font-family:"Poppins";font-style:normal;font-weight:400;src:url(/fonts/poppins/poppins-v15-latin-regular.eot);src:local("Poppins Regular"),local("Poppins-Regular"),url(/fonts/poppins/poppins-v15-latin-regular.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-regular.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-regular.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-regular.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-regular.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:"Poppins";font-style:italic;font-weight:400;src:url(/fonts/poppins/poppins-v15-latin-italic.eot);src:local("Poppins Italic"),local("Poppins-Italic"),url(/fonts/poppins/poppins-v15-latin-italic.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-italic.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-italic.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-italic.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-italic.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Poppins';font-style:normal;font-weight:600;src:url(/fonts/poppins/poppins-v15-latin-600.eot);src:local("Poppins SemiBold"),local("Poppins-SemiBold"),url(/fonts/poppins/poppins-v15-latin-600.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-600.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-600.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-600.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-600.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Poppins';font-style:italic;font-weight:600;src:url(/fonts/poppins/poppins-v15-latin-600italic.eot);src:local("Poppins SemiBold Italic"),local("Poppins-SemiBoldItalic"),url(/fonts/poppins/poppins-v15-latin-600italic.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-600italic.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-600italic.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-600italic.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-600italic.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Recoleta';src:url(/fonts/recoleta/Recoleta-Bold.woff2) format("woff2"),url(/fonts/recoleta/Recoleta-Bold.woff) format("woff"),url(/fonts/poppins/Recoleta-Bold.ttf) format("truetype");font-weight:700;font-style:bold}*{border:0;box-sizing:border-box}:root{font-size:16.5px}main img{content-visibility:auto}::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-thumb{background:#3e466b;border-radius:6px}::-webkit-scrollbar-thumb:hover{background:#aaa;cursor:pointer}::-webkit-scrollbar-track{background:#363948}::-webkit-scrollbar-corner{background:#282a36}body,html{font-family:"Poppins",Arial,Helvetica,sans-serif;font-size:16.5px}html{-webkit-text-size-adjust:100%}@supports (font-variation-settings:normal){html{font-family:"Poppins" var alt,Arial,Helvetica,sans-serif}}body{background:#282a36;color:#eee;margin:0;counter-reset:h2counter}b{font-weight:600;color:#8cc8ff}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}a,a:hover{text-decoration:none}a:hover{border-bottom:2px solid #ffd479}a.no-effect:hover{border-bottom:none}.page-note>h2:hover a:hover,a,a b{color:#ffd479}.intro a,a b:hover,a:hover{color:#fff}hr{border-bottom:1px solid #eee}img{max-width:100%}main{margin:0 auto}.page-note>h2,h1,h2{font-family:"Recoleta",Arial,Helvetica,sans-serif;font-size:24.75px}.page-note>h2,h1{font-size:29.7px}.page-note>h2{color:#eee;font-size:24.75px;margin:37.125px 0 19.8px}.page-note>h2:hover .direct-link{display:inline-block}.page-note .direct-link{display:none;color:#777;border-bottom:none;margin-left:3px}.page-note pre+h2{margin-top:37.125px}.page-note h1{counter-reset:h2counter}.page-note h2{counter-reset:h3counter}.page-note h2:before{content:counter(h2counter) ".Â Â ";counter-increment:h2counter;color:#8cc8ff}.container,header{width:100%;margin:0 auto}.normal{padding:0 16.5px;width:100%}@media (min-width:916.5px){.normal{width:900px}}.mt-2{margin-top:2rem}.page-index .container{padding:2rem 1rem 0}.page-index .main-cats{flex:0 1 calc(100% - 280px);padding-right:1rem}.page-index .main-cats>.category-wrapper{padding-bottom:1.5rem}.page-index .main-cats>.category-wrapper>.category{border:1px solid #3b3e54;border-radius:7px;height:fit-content;background:#2f3240;padding:2rem 1.5rem 1.5rem}.page-index .toc-index{border:1px solid #404040;border-radius:7px;height:fit-content;background:#35373c;flex:0 1 280px;position:sticky;top:60px;padding:1rem 1.1rem}.page-index .toc-index h3{padding-bottom:5px;border-bottom:1px solid #555;margin:0 0 10px;font-size:1.3rem}.page-index .toc-index ul{padding-left:20px;margin:0}.page-index .toc-index p{font-style:italic;color:#999;padding-top:0;margin-bottom:0;font-size:.95rem;margin-top:10px}.page-index .toc-index p a{color:#999;border-bottom:2px solid #999}.page-index .toc-index p a:hover{border-bottom:2px solid #ffd479}@media (max-width:991px){.page-index .main-cats{flex:1 1 100%;order:2;padding-right:0}.page-index .toc-index{flex:1 1 100%;order:1;position:inherit;margin-bottom:1.5rem}.page-index .toc-index ul{column-count:3;-webkit-column-count:3;-moz-column-count:3}}@media (max-width:767px){.page-index .toc-index ul{column-count:2;-webkit-column-count:2;-moz-column-count:2}}@media (max-width:575px){.page-index .toc-index ul{column-count:1;-webkit-column-count:1;-moz-column-count:1}}.category{width:100%}.category h2,header h1{font-size:1.55rem;margin-top:0}.category h2 img{float:left;margin-right:7px}.category .list-homepage{list-style:none;padding-left:10px;margin-bottom:0;column-count:1;-webkit-column-count:1;-moz-column-count:1}@media (min-width:768px){.category .list-homepage{column-count:2;-webkit-column-count:2;-moz-column-count:2}}@media (min-width:992px){.category .list-homepage{column-count:3;-webkit-column-count:3;-moz-column-count:3}}.category .list-homepage li{padding-left:15px;margin-bottom:10px;display:inline-block;width:100%}.category .list-homepage li a{color:#ddd;border-bottom:2px solid rgba(255,255,255,.14);border-style:dotted}.category .list-homepage li::before{content:"ðŸ“„";margin-right:5px;margin-left:-25px;opacity:.8}.category .list-homepage li:hover,.hsbox .hs__title{cursor:pointer}.category .list-homepage li:hover a{border-color:#ffd479;color:#fff}.category .list-homepage li:hover::before{opacity:1}.page-index header{padding-top:5em;padding-bottom:0}.page-index header .header-logo{height:120px;width:120px}header nav{z-index:10}#nav{z-index:2;position:relative}header{padding:5.5rem 1.5rem 1rem;width:900px;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header h1{font-size:2.2rem;margin-bottom:0}header p{margin-top:1rem}header .header-logo{width:55px;height:55px;margin-bottom:1rem}header .header-logo img{width:100%;height:100%}header .social{margin-top:.5rem}header #more-info #note-tag>a,header .social a{margin-right:10px}header .social a:last-child{margin-right:0}@media (min-width:992px){header .social a{margin-right:20px}}header .social a img{border-radius:50%}header #more-info{padding:1rem}header #more-info #note-tag{padding-bottom:10px;border-bottom:1px solid #444}header #more-info #note-tag>a::before{content:"#"}header #more-info #last-modified{padding-top:10px;font-style:italic}#reading-progress,nav{top:0;left:0;width:100vw}#reading-progress{z-index:3;border-bottom:1px solid #ffd479;position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}.intro,.job span{font-size:1.02rem}.intro b,.intro strong{color:#ffd479;font-weight:400}.job span{background:#ffd479;color:#000;padding:3px 10px;border-radius:15px}nav{position:fixed;padding:0 1.5rem;background:#35373c}nav nav #nav .nav-search .nav-search__input{padding-right:1.5rem}@media (max-width:992px){nav{padding:0 1rem}nav nav #nav .nav-search .nav-search__input{padding-right:1rem}}@media (max-width:576px){nav{padding:0 .5em}nav nav #nav .nav-search .nav-search__input{padding-right:.5rem}}nav #nav{display:-ms-flexbox;-ms-flex-align:center;align-items:center}nav #nav a{color:#ccc;margin-right:15px;align-items:center;padding:0 .5rem;font-size:1.1rem;white-space:nowrap}nav #nav a img{margin-right:5px}nav #nav a:hover{color:#fff;cursor:pointer;text-decoration:none}nav #nav .nav-item{text-align:left;margin-right:5px}@media (min-width:421px){nav #nav .nav-item{padding-left:0!important}}@media (max-width:575px){nav #nav .nav-item{width:unset!important}nav #nav .nav-item span{display:none}}@media (min-width:576px){nav #nav .nav-item{margin-right:15px}}nav #nav .nav-github{text-align:right;padding-right:0!important;margin-right:0!important}nav #nav .nav-github:hover img{filter:invert(.4)}nav #nav .nav-search{display:block;background-image:linear-gradient(to right,#3d4251,#3b3f4c,#393d46,#373a41,#35373c);width:100%;position:relative}nav #nav,nav #nav .nav-search form,nav #nav a{display:flex}nav #nav .nav-search .nav-search__input{border:0;background:0 0;color:#ddd;font-size:1.05rem;padding:.65rem .5rem;width:100%}nav #nav .nav-search .nav-search__input:focus{outline:0;border:0}nav #nav .nav-search #nav-search__result-container{position:absolute;max-height:80vh;overflow:auto;width:100%;background:#35373c;border-bottom-right-radius:5px;border-bottom-left-radius:5px;padding:0;filter:drop-shadow(2px 4px 6px #000)}@media (max-width:767px){nav #nav .nav-search #nav-search__result-container{position:fixed;left:0;right:0;border-radius:0}}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul{padding:0;margin:0;list-style:none}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li{display:flex;padding:10px;align-items:center;justify-content:space-between;overflow:hidden}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__icon{width:20px}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content{padding:0 10px;width:100%;overflow:hidden;text-overflow:ellipsis}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content h3{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content h3 a{color:#efb232;padding:0;text-align:left;font-weight:400;font-size:16.5px;line-height:1.5;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content h3 a:hover{border-bottom:none;color:#8cc8ff}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content p{text-align:left;margin:0;line-height:1.5;font-size:.95rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .enter{width:20px;display:none}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li.selected{background:#282a36}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li.selected .enter{display:block}nav #nav .nav-search #nav-search__result-container ul#nav-search__ul mark{background:0 0;color:inherit;box-shadow:inset 0 -3px 0 0 #fff}nav #nav .nav-search #nav-search__result-container #nav-search__no-result{padding:0 10px}nav #nav .nav-search #nav-search__result-container #nav-search__no-result p{text-align:left}footer{font-size:1rem;background:#35373c;padding:.75rem 1rem;text-align:center;margin-top:3rem}footer a{color:#ccc}footer a:hover{color:#fff}.hsbox{margin-bottom:24.75px;border:1px solid #969696;padding:1rem;border-radius:3px}.hsbox .hs__title::before{content:" ";display:inline-block;border-top:7px solid transparent;border-bottom:7px solid transparent;border-left:7px solid currentColor;vertical-align:middle;margin-right:.7rem;transform:translateY(-2px);transition:transform .2s ease-out}.hsbox .hs__title.show{padding-bottom:15px;border-bottom:.5px solid #666;margin-bottom:1rem}.hsbox .hs__title.show+.hs__content{display:block;opacity:1;padding:5px 0;transition:all .25s 0s cubic-bezier(.4,0,.2,1)}.hsbox .hs__title.show::before{transform:rotate(90deg) translateX(-3px)}.hsbox .hs__content{display:none;transition:all .2s 0s ease}.hsbox .hs__content>:last-child{margin-bottom:0}blockquote{margin:0;margin-bottom:1.5rem;padding-left:1rem;border-left:5px solid #aaa}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration{display:none}.page-note .text-center{text-align:center}.page-note ol,.page-note p,.page-note ul{margin-top:0;margin-bottom:24.75px}.page-note p+ol,.page-note p+ul{margin-top:-.5rem}.page-note ol li,.page-note ul li,div.toc ol li{margin-bottom:5px}.page-note ol li ol,.page-note ol li ul,.page-note ul li ol,.page-note ul li ul{margin-bottom:5px;padding-left:20px}.page-note ol li>*,.page-note ul li>*{margin-bottom:10px}.page-note p.noindent{display:none;padding-left:20px}.page-note p.noindent+ol,.page-note p.noindent+ul{padding-left:20px;margin-top:0}.page-note p.indent{display:none;padding-left:40px}.page-note ol.indent,.page-note p.indent+ol,.page-note p.indent+ul,.page-note ul.indent{padding-left:40px}.page-note ol.noindent,.page-note ul.noindent{padding-left:20px}.page-note hr{border-bottom:1px solid #676767;margin-bottom:24.75px}.page-note p.katex-block{overflow-x:auto;overflow-y:hidden}.page-note p.katex-block .katex-display{margin:0!important}#reading-list .item .author{font-style:italic}#reading-list .item .intro{color:#999}code[class*=language-],pre[class*=language-]{color:#eee;font-size:16px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#75a7ca}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}.token.comment{color:#6a9955}.token.punctuation{color:#eee}.token.inserted{color:#b5cea8}.token.builtin,.token.string{color:#ce9178}.token.operator{color:#eee}.token.function{color:#efefac}.token.class-name{color:#4ec9b0}.token.property,.token.variable{color:#9cdcfe}.token.tag{color:#90cdff}.token.tag .token.punctuation{color:gray}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}code,pre{font-family:Consolas,Menlo,Monaco,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L","Courier New",Courier,monospace;line-height:1.5}h2>code{font-size:21.78px!important}:not(pre)>code{border:1px solid #444;background:#6b444245;padding:2px 4px;margin:0 1px;border-radius:3px;font-size:.9rem;color:#fff;word-break:break-word}h2>code{color:#ddd;padding-right:6px}a>code{color:#ffd479}a:hover>code{color:#ccc}pre,pre[class*=language-]{margin:0 0 27.225px;overflow:auto}pre>code,pre[class*=language-]>code{display:block;padding:14.5px 16.5px 16.5px;background:#2f3240;border:.5px solid #3b3e54;overflow:auto;border-radius:3px;max-height:450px}div.toc{margin-bottom:24.75px;border:1px solid #3b3e54;border-radius:7px;height:fit-content;background:#2f3240;padding:15px 15px 10px 0}div.toc>ol::before{content:"In this note";display:block;padding-bottom:5px;border-bottom:1px solid #555;margin:0 0 15px;font-size:1.18rem;font-family:"Recoleta",Arial,Helvetica,sans-serif}div.toc ol{padding-left:20px;font-size:14.85px;margin-bottom:0}div.toc ol li code{font-size:.85rem;background:#ececec;padding:0 4px 2px}div.toc ol li ol{padding-left:10px;margin-top:7px}div.toc ol,div.toc ol ol{counter-reset:item;list-style-type:none}div.toc ol li::before{content:counters(item,".") ". ";counter-increment:item}div.toc>ol>li ol>li::before{opacity:.7}div.toc>ol>li::before{color:#8cc8ff}@media (min-width:1300px){div.toc{float:right;margin-right:-280px;border-left:none;width:250px;position:-webkit-sticky;position:sticky;top:60px;max-height:70vh;overflow:auto}div.toc ol{margin-top:0;margin-bottom:0}}@media (min-width:1500px){div.toc{margin-right:-310px;width:280px}}.toc-active>a{color:#fff!important}.toc-active::before{opacity:1!important}.page-note img{height:auto;width:100%}.page-note p>img+br,.page-note p>picture+br{display:none}</style></head><body><header><nav><div id="nav"><a href="/" class="nav-item no-effect"><img alt="home" height="18" src="/img/nav/home.svg" width="18"> <span>CK</span> </a><a href="/about/" class="nav-item no-effect"><img alt="about" height="15" src="/img/nav/about.svg" width="15"> <span>About</span></a><div id="nav-search" class="nav-search"><form><input aria-label="search notes (type &quot;/&quot; to focus &amp; &quot;ESC&quot; to lose)" class="nav-search__input" id="nav-search__input" onfocusin="inFocus(this)" placeholder="search notes (type &quot;/&quot; to focus &amp; &quot;ESC&quot; to lose)" type="search"></form><div id="nav-search__result-container" style="display: none;"><ul id="nav-search__ul"></ul><div id="nav-search__no-result" style="display: none;"><p>No results found.</p></div></div></div><a href="https://github.com/choonkiatlee" class="nav-item no-effect nav-github" target="_blank"><img alt="github" height="20" src="/img/nav/github.svg" width="20"></a></div><div id="reading-progress" aria-hidden="true"></div></nav><script src="/js/search.js?hash=1aae822ef9" async="" defer=""></script><div class="header-logo"><img alt="Raspbian on your laptop: QEMU" height="512" src="/img/header/data_viz.svg" width="512"></div><h1>Raspbian on your laptop: QEMU</h1><div id="more-info"><div id="note-tag"><a href="/tags/embedded-computing">Embedded Computing</a></div><div id="last-modified">29-12-2020 / <a href="https://github.com/choonkiatlee/choonkiatlee.github.io/edit/source/./posts/embedded/2020-04-20-Raspbian-QEMU.md">Edit on Github</a></div></div></header><main><article><div class="container mt-2 normal page-note"><div class="toc"><ol><li><a href="#tldr">TLDR ðŸ”—</a></li><li><a href="#motivation">Motivation ðŸ”—</a></li><li><a href="#first-steps%3A-qemu">First steps: QEMU ðŸ”—</a></li><li><a href="#now-for-some-code...">Now for some code... ðŸ”—</a></li></ol></div><h2 id="tldr">TLDR <a href="#tldr" class="direct-link">ðŸ”—</a></h2><p><a href="https://hub.docker.com/r/choonkiatlee/raspbian"><code>raspbian</code></a> is a docker image that allows you to run a fast raspbian image built for ARM directly on your x86 desktop. Test it out here:</p><pre class="language-bash"><code class="language-bash">docker run -it --rm choonkiatlee/raspbian:faithful</code></pre><h2 id="motivation">Motivation <a href="#motivation" class="direct-link">ðŸ”—</a></h2><p>Recently, I've been very interested in running machine learning algorithms on edge devices such as the Raspberry Pi.</p><p>Pytorch has released a new <a href="https://pytorch.org/docs/stable/jit.html">JIT</a> compilation feature. As explained in the linked documentation:</p><blockquote><p>TorchScript is a way to create serializable and optimizable models from PyTorch code. Any TorchScript program can be saved from a Python process and loaded in a process where there is no Python dependency.</p></blockquote><p>However, I could not find any pre-compiled pytorch wheels for my Raspberry Pi. Thus, I decided to compile my own wheels. However, the compilation process takes really long (&gt;36 hours) and so I decided to try leverage my own computer (or an Azure VM) to do the job for me instead.</p><h2 id="first-steps%3A-qemu">First steps: QEMU <a href="#first-steps%3A-qemu" class="direct-link">ðŸ”—</a></h2><p>I was first inspired by @nmilosev's article <a href="https://nmilosev.svbtle.com/compling-arm-stuff-without-an-arm-board-build-pytorch-for-the-raspberry-pi%5D">https://nmilosev.svbtle.com/compling-arm-stuff-without-an-arm-board-build-pytorch-for-the-raspberry-pi</a>.</p><p>The gist of the solution is that we can use the QEMU emulator to run programs compiled for ARM on our own x86 host machine. Using the qemu-user programs, we can use QEMU in the <code>User Mode Emulation</code> operation mode. In this mode, QEMU can launch Linux processes compiled for one CPU (Raspberry Pi) on another CPU (x86_64 host), and will translate syscalls on the fly. This way, we are still interfacing with the native kernel in the same way as any native piece of software.</p><p><picture><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/embedded/2020-12-26-qemu_emulation-1920w.webp 1920w, /img/post/embedded/2020-12-26-qemu_emulation-1280w.webp 1280w, /img/post/embedded/2020-12-26-qemu_emulation-640w.webp 640w, /img/post/embedded/2020-12-26-qemu_emulation-320w.webp 320w" type="image/webp"><source sizes="(max-width: 608px) 100vw, 608px" srcset="/img/post/embedded/2020-12-26-qemu_emulation-1920w.jpg 1920w, /img/post/embedded/2020-12-26-qemu_emulation-1280w.jpg 1280w, /img/post/embedded/2020-12-26-qemu_emulation-640w.jpg 640w, /img/post/embedded/2020-12-26-qemu_emulation-320w.jpg 320w" type="image/jpeg"><img alt="Comparison of emulation modes" height="463" src="/img/post/embedded/2020-12-26-qemu_emulation.png" width="1233" decoding="async" loading="lazy" style="background-size:cover;contain-intrinsic-size: min(var(--main-width), 1233px) min(calc(var(--main-width) * 0.37550689375506896), 463px);background-image:url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1233 463'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAFCAYAAACeuGYRAAAACXBIWXMAABcRAAAXEQHKJvM/AAABDElEQVQY02N4Vmb29mWDy9sX9U5vXza6vnhZbfv/SbFRMQMQPCo01H1eYfnmRYPrO6D8m5cNrm+fVVi/Zfi/keHi/+18F//vEAZikbP/N7M8AoqlgDR9Wsag9X8Tw4X/23kv/d8pAVGzifEiw8Hl1reOrXW9fXSd163j67yvHV5p++bAMqtMkKbdi6y1Dy23unl0jfPtY+v9bp3Y4H374DKrWwzGmZeuOpfeuOJUcu2KW/n1C5Z5V5/pp53PAGkyTDuraZx5+YpD8fWrrmXXrnhW3bxiAlTP4OLjI6qoaaCgpmcqJ6+hr2jh4Cy5eNM6FpCmnWfPMoYnJgioaBsqKOuayUmr6il6BQcLAwCiIH8rWfyvwQAAAABJRU5ErkJggg=='%3E%3C/image%3E%3C/svg%3E&quot;)"></picture></p><p>This brings much benefits as we no longer have to emulate all the hardware, which is slow. We also do not need to emulate the kernel, which is where most of the emulation computation takes place.</p><p>Once we've installed the QEMU user emulation software, we can run the Raspbian bash whilst mounting the Raspbian rootFS, which gives us a bash shell that for most intents and purposes mimics one running on the RPI!</p><h2 id="now-for-some-code...">Now for some code... <a href="#now-for-some-code..." class="direct-link">ðŸ”—</a></h2><p>The following instructions have been adapted from the very good tutorial <a href="https://wiki.debian.org/RaspberryPi/qemu-user-static">here!</a></p><ol><li><p>Install the QEMU emulation software</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># First, install the QEMU software</span><br><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span>  -y --no-install-recommends qemu binfmt-support qemu-user-static</code></pre></li><li><p>Mount or create a raspbian filesystem. You can either create a minimal rootfs from scratch using debootstrap or mount a pre-created raspbian image (eg: from the Raspberry Pi Foundation release).</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># 1. Create a minimal rootfs from scratch</span><br><span class="token function">mkdir</span> ~/rpi_mnt<br><br><span class="token function">wget</span> --no-check-certificate https://archive.raspbian.org/raspbian.public.key -O - <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -q<br><br><span class="token function">sudo</span> qemu-debootstrap --variant<span class="token operator">=</span><span class="token string">'minbase'</span> <br>                --keyring<span class="token operator">=</span>/etc/apt/trusted.gpg <span class="token punctuation">\</span><br>                --include<span class="token operator">=</span>python3,git,python3-pip <span class="token punctuation">\</span><br>                --arch armhf buster ~/rpi_mnt http://archive.raspbian.org/raspbian </code></pre><p>Or</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># 2. Mount an existing Raspbian Image</span><br>        <br><span class="token comment"># (Optional) Download the official Raspbian Image</span><br><span class="token function">wget</span> https://downloads.raspberrypi.org/raspbian_lite_latest<br><span class="token function">unzip</span> raspbian_lite_latest<br><br><span class="token comment"># Generate variables</span><br><span class="token variable assign-left">RPI_IMG_FILENAME</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">unzip</span> -Z -1 raspbian_lite_latest<span class="token variable">`</span></span><br><span class="token variable assign-left">LOOP_DEVICE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">sudo</span> losetup -f<span class="token variable">`</span></span>     <span class="token comment"># Find the name of the created loop device                      </span><br><br><span class="token comment"># Create a loopback device and mount it</span><br><span class="token function">mkdir</span> ~/rpi_mnt<br><span class="token function">sudo</span> losetup -f -P <span class="token variable">$RPI_IMG_FILENAME</span>   <br><span class="token function">sudo</span> <span class="token function">mount</span> <span class="token variable">${LOOP_DEVICE}</span>p2 -o rw rpi_mnt</code></pre></li><li><p>Prepare for chroot</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># Copy the quemu-arm-static binary into the image to be produced</span><br><span class="token function">sudo</span> <span class="token function">cp</span> /usr/bin/qemu-arm-static rpi_mnt/usr/bin<br><br><span class="token comment"># Backup /etc/ld.so.preload and remove it before chrooting in.</span><br><span class="token function">sudo</span> <span class="token function">mv</span> ~/rpi_mnt/etc/ld.so.preload ~/rpi_mnt/etc/ld.so.preload.backup<br><span class="token function">sudo</span> <span class="token function">touch</span> ~/rpi_mnt/etc/ld.so.preload<br><br><span class="token comment"># (Optional) -- Before chrooting in, mount device specific files from the host. Be careful though! Improper editing of these files can cause your host system to crash</span><br><span class="token comment"># mount --bind /dev ~/rpi_mnt/dev/</span><br><span class="token comment"># mount --bind /sys ~/rpi_mnt/sys/</span><br><span class="token comment"># mount --bind /proc ~/rpi_mnt/proc/</span><br><span class="token comment"># mount --bind /dev/pts ~/rpi_mnt/dev/pts</span></code></pre></li><li><p>Actually chroot in.</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># Preferably, use systemd-nspawn instead if your host system uses systemd. This is best practice and does a better job of islating the chroot environment from your host system</span><br><br><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> systemd-container<br>systemd-nspawn -D ~/rpi_mnt bin/bash</code></pre><p>Or</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># Alternatively, chroot in</span><br><span class="token function">chroot</span> <span class="token builtin class-name">.</span> ~/rpi_mntbin/bash    <br><br><span class="token comment"># Success! </span><br><span class="token function">uname</span> -a</code></pre></li></ol><p>This is extremely useful, and allows you to easily edit and test your distribution before you burn it to an SD card for the RPi!</p><p>However, this involves a lot of steps, and is hard to automate. In the next post, we will discuss how to create a docker container using the principles listed here to create our Raspbian docker image!</p><hr><p>References:</p><ul><li><a href="https://wiki.debian.org/RaspberryPi/qemu-user-static">https://wiki.debian.org/RaspberryPi/qemu-user-static</a></li><li><a href="https://nmilosev.svbtle.com/compling-arm-stuff-without-an-arm-board-build-pytorch-for-the-raspberry-pi">https://nmilosev.svbtle.com/compling-arm-stuff-without-an-arm-board-build-pytorch-for-the-raspberry-pi</a></li><li><a href="https://www.cnblogs.com/pengdonglin137/p/5020143.html#_lab2_0_0">https://www.cnblogs.com/pengdonglin137/p/5020143.html#_lab2_0_0</a></li></ul></div><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Raspbian on your laptop: QEMU","image":["https://choonkiatlee.github.io/img/post/embedded/2020-12-26-qemu_emulation.png"],"author":"","genre":"Insert a schema.org genre","url":"https://choonkiatlee.github.io/Raspbian-QEMU/","mainEntityOfPage":"https://choonkiatlee.github.io/Raspbian-QEMU/","datePublished":"20-04-2020","dateModified":"29-12-2020","description":"TLDR ðŸ”— raspbian is a docker image that allows you to run a fast raspbian image built for ARM directly on your x86 desktop. Test it out..."}</script></article></main><footer><a href="/" target="_blank">CK &nbsp;Â©&nbsp; 2020 </a>&nbsp;â€¢&nbsp; <a href="/about/">About me </a>&nbsp;â€¢&nbsp; <a href="https://github.com/dinhanhthi/dinhanhthi.com">Template Used</a></footer></body></html>